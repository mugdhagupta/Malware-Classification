#!/usr/bin/python
import numpy as np
import pandas as pd

csvfile = <path_to_csv_containing_data_and_families_as_labels>
family_type = <path_to_save_data_and_type_as_labels_in_csv>

df = pd.read_csv(csvfile)

count = 0
for i, fam in df.iterrows():
	row = df.at[i, 'family']
		
	if any(x in row for x in ["allaple", "vb", "yuner", "worms", "Autorun", "Mydoom", "Rebhip", "Spybot", "Vobfus", "Gaobot"]):
		df.at[i, 'family'] = "worms"
	elif any(x in row for x in ["virus", "krepper", "luder","sality", "Expiro", "Virut", "Ramnit", "Parite", "Mabezat", "Patchload"]):
		df.at[i, 'family'] = "virus"
	elif any(x in row for x in ["sventore_a", "sventore_c", "trojandrop", "Agent","Lamechi", "Small", "Sirefef"]):
		df.at[i, 'family'] = "trojandropper"
	elif any(x in row for x in ["renos", "trojdown_small", "trojdown", "tugspay", "Agent", "Banload", "Small", "Delf", "Adload", "Wintrim"]):
		df.at[i, 'family'] = "trojandownloader"
	elif any(x in row for x in ["startpage", "trojan", "trojan_Bulta", "comm", "BHO", "Koutodoor", "Alureon", "Vundo", "Agent", "Toga!rfn", "VB", "Bagsu!rfn", "Rimecud"]):
		df.at[i, 'family'] = "trojan"
	elif any(x in row for x in ["agent", "backdoor", "backdoor_rbot", "Zegost","Hupigon", "IRCbot", "Delf", "Cycbot", "Sdbot", "VB", "Bifrose"]):
		df.at[i, 'family'] = "backdoor"	
	else:
		count += 1
		df.at[i, 'family'] = "benign"
	print row, df.at[i, 'family']	


with open(family_type,'w') as f:
	df.to_csv(f, index = False)
	
print count
