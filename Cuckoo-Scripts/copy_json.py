from shutil import copyfile
from shutil import move
import os
import mmap
import shutil

upper = <path_of_cuckoo_reports_directory>
dest_json = <path_of_destination_json_reports_directory>  #put / in front 
dest_pcap = <path_of_destination_pcaps_directory>

counter = 1

for root, dirs, files in os.walk(upper):
	for f in files:
		if f == "cuckoo.log":
			filename = os.path.join(root, f)
			file  = open(filename, 'r').read()
			print filename
			warning = file.count('WARNING:')
			error = file.count('ERROR:')

			if warning == 0 and error == 0:
				lastindex = root.rfind('/')
			 
				if os.path.isfile(os.path.join(root, 'dump.pcap')) and os.path.isfile(root+"/reports/report.json"):	
					copyfile(root+"/reports/report.json", dest_json+ root[lastindex+1:] + ".json")
									
					pcap_dest_dir = os.path.join(dest_pcap, root[lastindex+1:])
					os.makedirs(pcap_dest_dir)				
					move(os.path.join(root, 'dump.pcap'), pcap_dest_dir)
					
					counter = counter+1




			


