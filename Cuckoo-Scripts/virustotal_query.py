import requests
import os, subprocess, time
import json
import hashlib

url = 'https://www.virustotal.com/vtapi/v2/file/report'
malicious_samples = <path_to_malware_directory>
reponse_dir = <path_to_response_directory>
count = 0
for root, dirs, files in os.walk(malicious_samples):
	for f in files:
		filename = os.path.join(root, f)
		count += 1		
		current_hash = hashlib.md5(open(filename,'rb').read()).hexdigest()
		
		params = {'apikey': <enter_api_key>, 'resource': current_hash, 'allinfo':False}

		response = requests.get(url, params=params)
		print response.json()
		json_decode = response.json()
		
		fi = os.path.join(reponse_dir, current_hash)
		with open(fi, 'w+') as outfile:
    			json.dump(json_decode, outfile) 


		
